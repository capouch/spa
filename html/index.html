<!DOCTYPE html>
<html>

<head>

 <!-- head content must come *after* these tags -->
 <meta charset="utf-8">
 <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <meta name="google-site-verification" content="bSX2l42ztWqeT7G7Pg-0ChidTrFwtASqMVZX7Z2Npao" />
 <meta name="fragment" content="!">

 <title>Our First SPA</title>

 <!-- Our "good enough for now" stylesheet -->
 <link class="css_a" rel="stylesheet" href="../css/main.css" type="text/css" />

 <!-- Third-party libraries -->

 <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
 <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
 <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

 <!--script src="https://cdn.socket.io/socket.io-1.3.5.js"></script-->
 <script src="/socket.io/socket.io.js"></script>
 <script src="../lib/page.js"></script>
 <script src="../lib/moment.js"></script>
 <script src="../lib/moment-duration-format.js"></script>

 <!-- Our Javascript -->
 <script class="script_a" src='../js/spa.js'></script>
 <script class="script_a" src='../js/spa.shell.js'></script>
 <!-- Feature modules -->
 <script class="script_a" src='../js/spa.dates.js'></script>
 <script class="script_a" src='../js/spa.socket.js'></script>
 <script class="script_a" src='../js/spa.seo.js'></script>

 <!-- Let's get started -->
 <script>
  $(function() {
  	//console.log("before");
   spa.initModule($('#spa'));
   //console.log("after");

  });
  console.log("outside before");

  // Set event handler to react to "stylesheet" message
  io.connect('http://localhost:8000').on( 'stylesheet', function ( path ) {
    console.log("in stylesheet");
    // Get rid of current style
    $( '.css_a' ).remove();
    // Replace contents of stylesheet with file from websocket
    $( 'head' ).append(
      '<link class="css_a" rel="stylesheet" href="'
      + path +
      '"/>'
    );
    // Redisplay HTML with new styling
    //$( 'body' ).html( b );
  });

  console.log("outside after");

 </script>

</head>

<body>
 <main id="spa"></main>
</body>

</html>
